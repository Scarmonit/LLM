<!DOCTYPE html>
<html>
<head>
    <title>üéØ Control YOUR Claude Browser</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        h1 { color: #4CAF50; }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            background: #333;
        }
        .success { background: #2d5016; border-left: 4px solid #4CAF50; }
        .error { background: #501616; border-left: 4px solid #f44336; }
        .info { background: #162850; border-left: 4px solid #2196F3; }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            margin: 10px 5px;
        }
        button:hover { background: #45a049; }
        button:disabled {
            background: #555;
            cursor: not-allowed;
        }
        textarea {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            background: #2a2a2a;
            color: #fff;
            border: 1px solid #555;
            border-radius: 5px;
            font-family: monospace;
        }
        #log {
            background: #000;
            padding: 15px;
            border-radius: 5px;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .log-entry {
            margin: 5px 0;
            padding: 3px 0;
        }
    </style>
</head>
<body>
    <h1>üéØ Control YOUR Claude Browser</h1>

    <div class="status info">
        <strong>Target:</strong> YOUR Claude page (ID: EB8352ECB91DD510AF0C01108085E147)<br>
        <strong>Status:</strong> <span id="status">Ready</span>
    </div>

    <textarea id="message" rows="4" placeholder="Type your message here...">Hello from automated control! Can you confirm you received this message?</textarea>

    <button id="sendBtn" onclick="sendMessage()">üì§ Send to YOUR Claude</button>
    <button onclick="sendMultiple()">üì® Send 3 Test Messages</button>
    <button onclick="clearLog()">üóëÔ∏è Clear Log</button>

    <h3>Activity Log:</h3>
    <div id="log"></div>

    <script>
        const YOUR_PAGE_ID = 'EB8352ECB91DD510AF0C01108085E147';
        let commandId = 1;

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.style.color = type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3';
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logDiv.appendChild(entry);
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function setStatus(text) {
            document.getElementById('status').textContent = text;
        }

        async function sendMessage() {
            const message = document.getElementById('message').value;
            if (!message.trim()) {
                alert('Please enter a message!');
                return;
            }

            const btn = document.getElementById('sendBtn');
            btn.disabled = true;
            setStatus('Connecting...');
            log(`Attempting to send: "${message}"`);

            try {
                const ws = new WebSocket(`ws://localhost:9222/devtools/page/${YOUR_PAGE_ID}`);

                ws.onopen = () => {
                    log('‚úÖ Connected to YOUR Claude!', 'success');
                    setStatus('Connected');

                    // Send command to type and submit
                    const command = {
                        id: commandId++,
                        method: 'Runtime.evaluate',
                        params: {
                            expression: `
                                (function() {
                                    const textarea = document.querySelector('textarea');
                                    if (!textarea) return 'ERROR: No textarea';

                                    textarea.focus();
                                    textarea.value = '';
                                    textarea.value = ${JSON.stringify(message)};
                                    textarea.dispatchEvent(new Event('input', { bubbles: true }));

                                    setTimeout(() => {
                                        const evt = new KeyboardEvent('keydown', {
                                            key: 'Enter',
                                            keyCode: 13,
                                            ctrlKey: true,
                                            bubbles: true
                                        });
                                        textarea.dispatchEvent(evt);
                                    }, 100);

                                    return 'SUCCESS';
                                })()
                            `,
                            awaitPromise: false,
                            returnByValue: true
                        }
                    };

                    ws.send(JSON.stringify(command));
                };

                ws.onmessage = (event) => {
                    const response = JSON.parse(event.data);
                    if (response.id) {
                        log('‚úÖ Message sent to YOUR Claude!', 'success');
                        log('üëâ Check your Claude browser to see the message!', 'success');
                        setStatus('Message Sent');
                        ws.close();
                    }
                };

                ws.onerror = (error) => {
                    log('‚ùå Connection error - Is Chrome running with --remote-debugging-port=9222?', 'error');
                    setStatus('Error');
                };

                ws.onclose = () => {
                    btn.disabled = false;
                };

            } catch (err) {
                log(`‚ùå Error: ${err.message}`, 'error');
                setStatus('Error');
                btn.disabled = false;
            }
        }

        async function sendMultiple() {
            const messages = [
                "Automated test message #1",
                "Automated test message #2",
                "Automated test message #3"
            ];

            for (let i = 0; i < messages.length; i++) {
                document.getElementById('message').value = messages[i];
                await sendMessage();
                await new Promise(r => setTimeout(r, 5000));
            }
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
        }

        log('üéØ Control panel ready!');
        log('üëâ Type a message and click "Send to YOUR Claude"');
    </script>
</body>
</html>
